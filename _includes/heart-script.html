<script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbzojJs3Kmetk8BeVVFNmuAWzKTckuQyEIiptjZCiq37D9M31JgZEYKtZ-8PV7zWpPhi/exec';
    const searchInput = document.getElementById('searchInput');
    const projectCards = document.querySelectorAll('.project-card');
    const noResult = document.getElementById('noResult');

    if (searchInput) {
        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            let hasVisible = false;

            projectCards.forEach(card => {
                const title = card.getAttribute('data-title');
                if (title.includes(term)) {
                    card.style.display = 'flex';
                    hasVisible = true;
                } else {
                    card.style.display = 'none';
                }
            });
            noResult.style.display = hasVisible ? 'none' : 'block';
        });
    }

    document.querySelectorAll('.heart-count').forEach(span => {
        const id = span.id.replace('count-', '');
        fetch(`${GAS_URL}?action=get&id=${id}`)
            .then(res => res.text())
            .then(count => {
                if (count) span.innerText = count;
            });
    });

    function handleHeartClick(btn, id) {
        const countSpan = btn.querySelector('.heart-count');
        btn.style.pointerEvents = 'none'; 

        fetch(`${GAS_URL}?action=add&id=${id}`)
            .then(res => res.text())
            .then(newCount => {
                countSpan.innerText = newCount;
                btn.style.transform = "scale(1.3)";
                setTimeout(() => {
                    btn.style.transform = "scale(1)";
                    btn.style.pointerEvents = 'auto';
                }, 200);
            });
    }
</script>