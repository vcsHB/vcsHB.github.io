<script>
    function openTab(evt, tabName) {
        const tabcontents = document.getElementsByClassName("tab-content");
        for (let i = 0; i < tabcontents.length; i++) {
            tabcontents[i].classList.remove("active");
        }

        const tablinks = document.getElementsByClassName("tab-link");
        for (let i = 0; i < tablinks.length; i++) {
            tablinks[i].classList.remove("active");
        }

        document.getElementById(tabName).classList.add("active");
        evt.currentTarget.classList.add("active");

        if (tabName === 'Profile') {
            loadProfileReadme();
        }
    }

    function loadProfileReadme() {
        const container = document.querySelector('.github-profile-readme');
        if (!container || container.innerHTML.trim() !== "") return;

        fetch('/assets/profile.md')
            .then(response => {
                if (!response.ok) throw new Error('404');
                return response.text();
            })
            .then(markdown => {
                if (window.marked) {
                    container.innerHTML = marked.parse(markdown);
                    if (window.Prism) Prism.highlightAll();
                    setTimeout(() => container.classList.add('active'), 50);
                }
            })
            .catch(() => {
                container.innerHTML = '<p>README를 불러올 수 없습니다. (_data/profile.md 파일을 확인하세요)</p>';
            });
    }

    document.addEventListener("DOMContentLoaded", function () {
        const activeTab = document.querySelector('.tab-link.active');
        if (activeTab) {
            const onclickAttr = activeTab.getAttribute('onclick');
            if (onclickAttr && onclickAttr.includes('Profile')) {
                loadProfileReadme();
            }
        }
    });
</script>